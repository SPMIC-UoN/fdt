<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd"><HTML><HEAD><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><link REL="stylesheet" TYPE="text/css" href="../fsl.css"><TITLE>FSL</TITLE></HEAD><BODY><IFRAME width="100%" scrolling="no" frameborder="0" src="fdt_top.html">Broken</IFRAME><h3>Surface formats in PROBTRACKX</h3><p><b>Important notes:</b> <ul><li>In the near future, probtrackx will also support the GIFTI format, and the formats used below will probably become <i>obsolete</i>.<li>The surface file formats below admit one scalar value per vertex. If all these values are set to 0, then probtrackx will consider the whole surface as an ROI. If a subset of the vertices is non-zero, then probtrackx will <u>only consider this subset as the ROI mask</u>.</ul></p><p>Probtrackx accepts two types of surface formats, both need to be stored as ASCII text files.<ol><li> FIRST-type format ( .vtk) <br>These files have the following format:<br><pre>  # vtk DataFile Version 3.0  this file was written using fslvtkio  ASCII  DATASET POLYDATA  POINTS <b><u>N</u></b> float  x1 y1 z1   x2 y2 z2  ...  xN yN zN  POLYGONS <b><u>M</u></b> <b><u>P</u></b>  3 i1 j1 k1  3 i2 j2 k2  ...  3 iM jM kM  POINT_DATA <b><u>N</u></b>  SCALARS Scalars float  LOOKUP_TABLE default  s1  s2  ...  sN</pre><p>The values that are in <b><u>underligned bold</u></b> are specific to the surface that is being handled. These are the number of vertices (N), the number of polygons (M), and the number of polygons times the number of vertices per polygon (P), e.g. in this case the polygons are triangles, i.e. P=3*M. This number also appears at the start of each line in the polygon definition. Note that the polygon IDs start at 0.</p><p>The coordinates <code>xn yn zn</code> are in mm space as produced by one of the 3 softwares. You will then need to tell probtrackx which convention is being used (see probtrackx command-line doc)</p><li> Caret and FreeSurfer format (.asc)<br>These files have the following format:<pre>  #!ascii file  <b><u>N</u></b> <b><u>M</u></b>  x1 y1 z1 val1  x2 y2 z2 val2  ...  xN yN zN valN   i1 j1 k1 0  i2 i2 k2 0  ...  iM jM kM 0</pre><p>The numbers N and M mean the same thing as in the FIRST example above.</p></ol></p><h3>Creating surface files from other softwares</h3><h4>From FreeSurfer</h4><p>In FreeSurfer, the type of surfaces that you are likely to create are either whole hemisphere cortical surface or a region of interest drawn on a surface.</p><ul><li><p>In the case of a whole hemisphere surface, the related files are often stored in <code>$SUBJECTS_DIR/&lt;subject&gt;/surf</code>. For example, the surface file for the left hemisphere grey/white interface is called <code>lh.white</code>.</p><p>You can convert this file to ASCII format (hence making it readable by probtrackx) using the FreeSurfer command:<pre><code>  mris_convert lh.white lh.white.asc</code></pre></p><li><p>In the case of a sub-region of the cortical surface (created, e.g., using FreeSurfer's <i>tksurfer</i>, or the automated labelling tool), the likely format for these ROIs is .label. This file contains the IDs of surface vertices that the ROI contains, but does not have information on the surface itself. Hence, in order to use it in prbtrackx, you will need to create a surface file that has 0's outside and 1's at the ROI's vertices.</p><p>You can convert your label file into a "labelled" surface file, or combine several labels into the same surface ROI, using:<pre><code>   echo roi1.label roi2.label roi3.label &gt; list.txt   label2surf --surf=lh.white.asc --out=outsurf.asc --labels=list.txt</code></pre></p></ul><h4>From Caret</h4><p>In Caret, you are likely to be using a surface file that is stored, e.g., in GIFTI format, or as a pair (file.coord, file.topo). In order to transform this to a ASCII file, you can use the Caret command:<pre><code>  caret_command -file-convert -format-convert ASCII myfile.coord myfile.topo</code>  or<code>  caret_command -file-convert -format-convert ASCII myfile.gii</code></pre></p><h4>From FIRST</h4><p>Nothing to be done here, you can use the output from FIRST (the .vtk files) directly in probtrackx.</p>